{"version":3,"file":"panel-ladder.js","names":["LadderRoom","_PSRoom","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","classType","format","id","split","notice","searchValue","lastSearch","loading","error","ladderData","setNotice","update","setSearchValue","setLastSearch","setLoading","setError","message","setLadderData","requestLadderData","_PS","PS","teams","usesLocalLadder","send","toID","undefined","Net","get","query","server","output","prefix","then","PSRoom","LadderFormat","props","room","changeSearch","e","currentTarget","value","submitSearch","preventDefault","RenderHeader","preact","h","BattleLog","escapeFormat","escapeHTML","RenderSearch","onSubmit","type","name","placeholder","onChange","RenderFormat","BattleFormats","Fragment","SanitizedHTML","LadderPanel","_PSRoomPanel","_proto","prototype","componentDidMount","_this2","subscriptions","push","subscribe","response","Error","forceUpdate","render","PSPanelWrapper","scrollable","ShowFormatList","PSRoomPanel","_class2","Notice","style","BattleFormatList","currentSection","sections","formats","_i2","_Object$entries2","Object","entries","_ref","key","rated","searchShow","section","href","Config","routes","users","target","roomTypes","Model","Component","updateRoomTypes"],"sources":["../src/panel-ladder.tsx"],"sourcesContent":["/**\r\n * Ladder Panel\r\n *\r\n * Panel for ladder formats and associated ladder tables.\r\n *\r\n * @author Adam Tran <aviettran@gmail.com>\r\n * @license MIT\r\n */\r\n\r\nclass LadderRoom extends PSRoom {\r\n\treadonly classType: string = 'ladder';\r\n\treadonly format?: string = this.id.split('-')[1];\r\n\tnotice?: string;\r\n\tsearchValue: string = '';\r\n\tlastSearch: string = '';\r\n\tloading: boolean = false;\r\n\terror?: string;\r\n\tladderData?: string;\r\n\r\n\tsetNotice = (notice: string) => {\r\n\t\tthis.notice = notice;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetSearchValue = (searchValue: string) => {\r\n\t\tthis.searchValue = searchValue;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetLastSearch = (lastSearch: string) => {\r\n\t\tthis.lastSearch = lastSearch;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetLoading = (loading: boolean) => {\r\n\t\tthis.loading = loading;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetError = (error: Error) => {\r\n\t\tthis.loading = false;\r\n\t\tthis.error = error.message;\r\n\t\tthis.update(null);\r\n\t};\r\n\tsetLadderData = (ladderData: string | undefined) => {\r\n\t\tthis.loading = false;\r\n\t\tthis.ladderData = ladderData;\r\n\t\tthis.update(null);\r\n\t};\r\n\trequestLadderData = (searchValue?: string) => {\r\n\t\tconst { teams } = PS;\r\n\t\tif (teams.usesLocalLadder) {\r\n\t\t\tthis.send(`/cmd laddertop ${this.format} ${toID(this.searchValue)}`);\r\n\t\t} else if (this.format !== undefined) {\r\n\t\t\tNet('/ladder.php')\r\n\t\t\t\t.get({\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tformat: this.format,\r\n\t\t\t\t\t\tserver: PS.server.id,\r\n\t\t\t\t\t\toutput: 'html',\r\n\t\t\t\t\t\tprefix: toID(searchValue),\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t\t.then(this.setLadderData)\r\n\t\t\t\t.catch(this.setError);\r\n\t\t}\r\n\t\tthis.setLoading(true);\r\n\t};\r\n}\r\n\r\nfunction LadderFormat(props: {room: LadderRoom}) {\r\n\tconst {room} = props;\r\n\tconst {\r\n\t\tformat, searchValue, lastSearch, loading, error, ladderData,\r\n\t\tsetSearchValue, setLastSearch, requestLadderData,\r\n\t} = room;\r\n\tif (format === undefined) return null;\r\n\r\n\tconst changeSearch = (e: Event) => {\r\n\t\tsetSearchValue((e.currentTarget as HTMLInputElement).value);\r\n\t};\r\n\tconst submitSearch = (e: Event) => {\r\n\t\te.preventDefault();\r\n\t\tsetLastSearch(room.searchValue);\r\n\t\trequestLadderData(room.searchValue);\r\n\t};\r\n\tconst RenderHeader = () => {\r\n\t\tif (!PS.teams.usesLocalLadder) {\r\n\t\t\treturn <h3>\r\n\t\t\t\t{BattleLog.escapeFormat(format)} Top{\" \"}\r\n\t\t\t\t{BattleLog.escapeHTML(lastSearch ? `- '${lastSearch}'` : \"500\")}\r\n\t\t\t</h3>;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\tconst RenderSearch = () => {\r\n\t\tif (!PS.teams.usesLocalLadder) {\r\n\t\t\treturn <form class=\"search\" onSubmit={submitSearch}>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tname=\"searchValue\"\r\n\t\t\t\t\tclass=\"textbox searchinput\"\r\n\t\t\t\t\tvalue={BattleLog.escapeHTML(searchValue)}\r\n\t\t\t\t\tplaceholder=\"username prefix\"\r\n\t\t\t\t\tonChange={changeSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<button type=\"submit\"> Search</button>\r\n\t\t\t</form>;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\tconst RenderFormat = () => {\r\n\t\tif (loading || !BattleFormats) {\r\n\t\t\treturn <p>Loading...</p>;\r\n\t\t} else if (error !== undefined) {\r\n\t\t\treturn <p>Error: {error}</p>;\r\n\t\t} else if (BattleFormats[format] === undefined) {\r\n\t\t\treturn <p>Format {format} not found.</p>;\r\n\t\t} else if (ladderData === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn <>\r\n\t\t\t<p>\r\n\t\t\t\t<button class=\"button\" data-href=\"ladder\" data-target=\"replace\" >\r\n\t\t\t\t\t<i class=\"fa fa-refresh\"></i> Refresh\r\n\t\t\t\t</button>\r\n\t\t\t\t<RenderSearch/>\r\n\t\t\t</p>\r\n\t\t\t<RenderHeader/>\r\n\t\t\t<SanitizedHTML>{ladderData}</SanitizedHTML>\r\n\t\t</>;\r\n\t};\r\n\treturn <div class=\"ladder pad\">\r\n\t\t<p>\r\n\t\t<button class=\"button\" data-href=\"ladder\" data-target=\"replace\">\r\n\t\t\t\t<i class=\"fa fa-chevron-left\"></i> Format List\r\n\t\t\t</button>\r\n\t\t</p>\r\n\t\t<RenderFormat />\r\n\t</div>;\r\n}\r\n\r\nclass LadderPanel extends PSRoomPanel<LadderRoom> {\r\n\tcomponentDidMount() {\r\n\t\tconst {room} = this.props;\r\n\t\t// Request ladder data either on mount or after BattleFormats are loaded\r\n\t\tif (BattleFormats && room.format !== undefined) room.requestLadderData();\r\n\t\tthis.subscriptions.push(\r\n\t\t\troom.subscribe((response: any) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tconst [format, ladderData] = response;\r\n\t\t\t\t\tif (room.format === format) {\r\n\t\t\t\t\t\tif (!ladderData) {\r\n\t\t\t\t\t\t\troom.setError(new Error('No data returned from server.'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\troom.setLadderData(ladderData);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.forceUpdate();\r\n\t\t\t})\r\n\t\t);\r\n\t\tthis.subscriptions.push(\r\n\t\t\tPS.teams.subscribe(() => {\r\n\t\t\t\tif (room.format !== undefined) room.requestLadderData();\r\n\t\t\t\tthis.forceUpdate();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\tstatic Notice = (props: {notice: string | undefined}) => {\r\n\t\tconst {notice} = props;\r\n\t\tif (notice) {\r\n\t\t\treturn (\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<strong style=\"color:red\">{notice}</strong>\r\n\t\t\t\t</p>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\tstatic BattleFormatList = () => {\r\n\t\tif (!BattleFormats) {\r\n\t\t\treturn <p>Loading...</p>;\r\n\t\t}\r\n\t\tlet currentSection: string = \"\";\r\n\t\tlet sections: JSX.Element[] = [];\r\n\t\tlet formats: JSX.Element[] = [];\r\n\t\tfor (const [key, format] of Object.entries(BattleFormats)) {\r\n\t\t\tif (!format.rated || !format.searchShow) continue;\r\n\t\t\tif (format.section !== currentSection) {\r\n\t\t\t\tif (formats.length > 0) {\r\n\t\t\t\t\tsections.push(<preact.Fragment key={currentSection}>\r\n\t\t\t\t\t\t<h3>{currentSection}</h3>\r\n\t\t\t\t\t\t<ul style=\"list-style:none;margin:0;padding:0\">\r\n\t\t\t\t\t\t\t{formats}\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</preact.Fragment>);\r\n\t\t\t\t\tformats = [];\r\n\t\t\t\t}\r\n\t\t\t\tcurrentSection = format.section;\r\n\t\t\t}\r\n\t\t\tformats.push(\r\n\t\t\t\t<li key={key} style=\"margin:5px\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tname=\"joinRoom\"\r\n\t\t\t\t\t\tvalue={`ladder-${key}`}\r\n\t\t\t\t\t\tclass=\"button\"\r\n\t\t\t\t\t\tstyle=\"width:320px;height:30px;text-align:left;font:12pt Verdana\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{BattleLog.escapeFormat(format.id)}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</li>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn <>{sections}</>;\r\n\t};\r\n\tstatic ShowFormatList = (props: {room: LadderRoom}) => {\r\n\t\tconst {room} = props;\r\n\t\treturn <>\r\n\t\t\t<p>\r\n\t\t\t\t<a class=\"button\" href={`/${Config.routes.users}/`} target=\"_blank\">\r\n\t\t\t\t\tLook up a specific user's rating\r\n\t\t\t\t</a>\r\n\t\t\t</p>\r\n\t\t\t<LadderPanel.Notice notice={room.notice} />\r\n\t\t\t<p>\r\n\t\t\t\t<button name=\"joinRoom\" value=\"view-ladderhelp\" class=\"button\">\r\n\t\t\t\t\t<i class=\"fa fa-info-circle\"></i> How the ladder works\r\n\t\t\t\t</button>\r\n\t\t\t</p>\r\n\t\t\t<LadderPanel.BattleFormatList />\r\n\t\t</>;\r\n\t};\r\n\trender() {\r\n\t\tconst {room} = this.props;\r\n\t\treturn <PSPanelWrapper room={room} scrollable>\r\n\t\t\t<div class=\"ladder pad\">\r\n\t\t\t\t{room.format === undefined && (\r\n\t\t\t\t\t<LadderPanel.ShowFormatList room={room} />\r\n\t\t\t\t)}\r\n\t\t\t\t{room.format !== undefined && <LadderFormat room={room} />}\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.roomTypes['ladder'] = {\r\n\tModel: LadderRoom,\r\n\tComponent: LadderPanel,\r\n};\r\nPS.updateRoomTypes();\r\n"],"mappings":"mXAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAPA;;AASMA,UAAU,UAAAC,OAAA,EAAAC,cAAA,CAAAF,UAAA,CAAAC,OAAA,WAAAD,WAAA,MAAAG,KAAA,SAAAC,IAAA,CAAAC,SAAA,CAAAC,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAAJ,IAAA,EAAAK,IAAA,GAAAA,IAAA,CAAAL,IAAA,CAAAK,IAAA,IAAAF,IAAA,CAAAE,IAAA,EAAAJ,SAAA,CAAAI,IAAA,GAAAN,KAAA,CAAAF,OAAA,CAAAS,IAAA,CAAAC,KAAA,CAAAV,OAAA,QAAAW,MAAA,CAAAL,IAAA,SAAAJ,KAAA;AACNU,SAAS,CAAW,QAAQ,CAAAV,KAAA;AAC5BW,MAAM,CAAYX,KAAA,CAAKY,EAAE,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAAb,KAAA;AAChDc,MAAM,QAAAd,KAAA;AACNe,WAAW,CAAW,EAAE,CAAAf,KAAA;AACxBgB,UAAU,CAAW,EAAE,CAAAhB,KAAA;AACvBiB,OAAO,CAAY,KAAK,CAAAjB,KAAA;AACxBkB,KAAK,QAAAlB,KAAA;AACLmB,UAAU,QAAAnB,KAAA;;AAEVoB,SAAS,CAAG,SAACN,MAAc,CAAK;AAC/Bd,KAAA,CAAKc,MAAM,CAAGA,MAAM;AACpBd,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACDsB,cAAc,CAAG,SAACP,WAAmB,CAAK;AACzCf,KAAA,CAAKe,WAAW,CAAGA,WAAW;AAC9Bf,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACDuB,aAAa,CAAG,SAACP,UAAkB,CAAK;AACvChB,KAAA,CAAKgB,UAAU,CAAGA,UAAU;AAC5BhB,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACDwB,UAAU,CAAG,SAACP,OAAgB,CAAK;AAClCjB,KAAA,CAAKiB,OAAO,CAAGA,OAAO;AACtBjB,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACDyB,QAAQ,CAAG,SAACP,KAAY,CAAK;AAC5BlB,KAAA,CAAKiB,OAAO,CAAG,KAAK;AACpBjB,KAAA,CAAKkB,KAAK,CAAGA,KAAK,CAACQ,OAAO;AAC1B1B,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACD2B,aAAa,CAAG,SAACR,UAA8B,CAAK;AACnDnB,KAAA,CAAKiB,OAAO,CAAG,KAAK;AACpBjB,KAAA,CAAKmB,UAAU,CAAGA,UAAU;AAC5BnB,KAAA,CAAKqB,MAAM,CAAC,IAAI,CAAC;AAClB,CAAC,CAAArB,KAAA;AACD4B,iBAAiB,CAAG,SAACb,WAAoB,CAAK;AAC7C,IAAAc,GAAA,CAAkBC,EAAE,CAAZC,KAAK,CAAAF,GAAA,CAALE,KAAK;AACb,GAAIA,KAAK,CAACC,eAAe,CAAE;AAC1BhC,KAAA,CAAKiC,IAAI,mBAAmBjC,KAAA,CAAKW,MAAM,KAAIuB,IAAI,CAAClC,KAAA,CAAKe,WAAW,CAAG,CAAC;AACrE,CAAC,IAAM,IAAIf,KAAA,CAAKW,MAAM,GAAKwB,SAAS,CAAE;AACrCC,GAAG,CAAC,aAAa,CAAC;AAChBC,GAAG,CAAC;AACJC,KAAK,CAAE;AACN3B,MAAM,CAAEX,KAAA,CAAKW,MAAM;AACnB4B,MAAM,CAAET,EAAE,CAACS,MAAM,CAAC3B,EAAE;AACpB4B,MAAM,CAAE,MAAM;AACdC,MAAM,CAAEP,IAAI,CAACnB,WAAW;AACzB;AACD,CAAC,CAAC;AACD2B,IAAI,CAAC1C,KAAA,CAAK2B,aAAa,CAAC,SACnB;AAAC3B,KAAA,CAAKyB,QAAQ,CAAC;AACvB;AACAzB,KAAA,CAAKwB,UAAU,CAAC,IAAI,CAAC;AACtB,CAAC,QAAAxB,KAAA,SAAAH,UAAA,GAtDuB8C,MAAM;;;AAyD/B,QAAS,CAAAC,YAAYA,CAACC,KAAyB,CAAE;AAChD,GAAO,CAAAC,IAAI,CAAID,KAAK,CAAbC,IAAI;AACX;AACCnC,MAAM;;AAEHmC,IAAI,CAFPnC,MAAM,CAAEI,WAAW,CAEhB+B,IAAI,CAFC/B,WAAW,CAAEC,UAAU,CAE5B8B,IAAI,CAFc9B,UAAU,CAAEC,OAAO,CAErC6B,IAAI,CAF0B7B,OAAO,CAAEC,KAAK,CAE5C4B,IAAI,CAFmC5B,KAAK,CAAEC,UAAU,CAExD2B,IAAI,CAF0C3B,UAAU,CAC3DG,cAAc,CACXwB,IAAI,CADPxB,cAAc,CAAEC,aAAa,CAC1BuB,IAAI,CADSvB,aAAa,CAAEK,iBAAiB,CAC7CkB,IAAI,CADwBlB,iBAAiB;AAEjD,GAAIjB,MAAM,GAAKwB,SAAS,CAAE,MAAO,KAAI;;AAErC,GAAM,CAAAY,YAAY,CAAG,QAAAA,CAACC,CAAQ,CAAK;AAClC1B,cAAc,CAAE0B,CAAC,CAACC,aAAa,CAAsBC,KAAK,CAAC;AAC5D,CAAC;AACD,GAAM,CAAAC,YAAY,CAAG,QAAAA,CAACH,CAAQ,CAAK;AAClCA,CAAC,CAACI,cAAc,CAAC,CAAC;AAClB7B,aAAa,CAACuB,IAAI,CAAC/B,WAAW,CAAC;AAC/Ba,iBAAiB,CAACkB,IAAI,CAAC/B,WAAW,CAAC;AACpC,CAAC;AACD,GAAM,CAAAsC,YAAY,CAAG,QAAAA,CAAA,CAAM;AAC1B,GAAI,CAACvB,EAAE,CAACC,KAAK,CAACC,eAAe,CAAE;AAC9B,MAAO,CAAAsB,MAAA,CAAAC,CAAA;AACLC,SAAS,CAACC,YAAY,CAAC9C,MAAM,CAAC,CAAC,MAAI,CAAC,GAAG;AACvC6C,SAAS,CAACE,UAAU,CAAC1C,UAAU,OAASA,UAAU,KAAM,KAAK;AAC3D,CAAC;AACN;AACA,MAAO,KAAI;AACZ,CAAC;AACD,GAAM,CAAA2C,YAAY,CAAG,QAAAA,CAAA,CAAM;AAC1B,GAAI,CAAC7B,EAAE,CAACC,KAAK,CAACC,eAAe,CAAE;AAC9B,MAAO,CAAAsB,MAAA,CAAAC,CAAA,SAAM,QAAM,QAAQ,CAACK,QAAQ,CAAET,YAAa;AAClDG,MAAA,CAAAC,CAAA;AACCM,IAAI,CAAC,MAAM;AACXC,IAAI,CAAC,aAAa;AAClB,QAAM,qBAAqB;AAC3BZ,KAAK,CAAEM,SAAS,CAACE,UAAU,CAAC3C,WAAW,CAAE;AACzCgD,WAAW,CAAC,iBAAiB;AAC7BC,QAAQ,CAAEjB,YAAa;AACvB,CAAC;AACFO,MAAA,CAAAC,CAAA,WAAQM,IAAI,CAAC,QAAQ,EAAC,SAAe;AAChC,CAAC;AACR;AACA,MAAO,KAAI;AACZ,CAAC;AACD,GAAM,CAAAI,YAAY,CAAG,QAAAA,CAAA,CAAM;AAC1B,GAAIhD,OAAO,EAAI,CAACiD,aAAa,CAAE;AAC9B,MAAO,CAAAZ,MAAA,CAAAC,CAAA,UAAG,YAAa,CAAC;AACzB,CAAC,IAAM,IAAIrC,KAAK,GAAKiB,SAAS,CAAE;AAC/B,MAAO,CAAAmB,MAAA,CAAAC,CAAA,UAAG,SAAO,CAACrC,KAAS,CAAC;AAC7B,CAAC,IAAM,IAAIgD,aAAa,CAACvD,MAAM,CAAC,GAAKwB,SAAS,CAAE;AAC/C,MAAO,CAAAmB,MAAA,CAAAC,CAAA,UAAG,SAAO,CAAC5C,MAAM,CAAC,aAAc,CAAC;AACzC,CAAC,IAAM,IAAIQ,UAAU,GAAKgB,SAAS,CAAE;AACpC,MAAO,KAAI;AACZ;AACA,MAAO,CAAAmB,MAAA,CAAAC,CAAA,CAAAD,MAAA,CAAAa,QAAA;AACNb,MAAA,CAAAC,CAAA;AACCD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,YAAU,QAAQ,CAAC,cAAY,SAAS;AAC9DD,MAAA,CAAAC,CAAA,MAAG,QAAM,eAAe,CAAI,CAAC;AACtB,CAAC;AACTD,MAAA,CAAAC,CAAA,CAACI,YAAY,KAAC;AACZ,CAAC;AACJL,MAAA,CAAAC,CAAA,CAACF,YAAY,KAAC,CAAC;AACfC,MAAA,CAAAC,CAAA,CAACa,aAAa,MAAEjD,UAA0B;AACzC,CAAC;AACJ,CAAC;AACD,MAAO,CAAAmC,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY;AAC7BD,MAAA,CAAAC,CAAA;AACAD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,YAAU,QAAQ,CAAC,cAAY,SAAS;AAC7DD,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAI,CAAC;AAC3B;AACN,CAAC;AACJD,MAAA,CAAAC,CAAA,CAACU,YAAY,KAAE;AACX,CAAC;AACP,CAAC;;AAEKI,WAAW,UAAAC,YAAA,EAAAvE,cAAA,CAAAsE,WAAA,CAAAC,YAAA,WAAAD,YAAA,SAAAC,YAAA,CAAA9D,KAAA,MAAAN,SAAA,aAAAqE,MAAA,CAAAF,WAAA,CAAAG,SAAA,CAAAD,MAAA;AAChBE,iBAAiB,CAAjB,SAAAA,kBAAA,CAAoB,KAAAC,MAAA;AACnB,GAAO,CAAA5B,IAAI,CAAI,IAAI,CAACD,KAAK,CAAlBC,IAAI;;AAEX,GAAIoB,aAAa,EAAIpB,IAAI,CAACnC,MAAM,GAAKwB,SAAS,CAAEW,IAAI,CAAClB,iBAAiB,CAAC,CAAC;AACxE,IAAI,CAAC+C,aAAa,CAACC,IAAI;AACtB9B,IAAI,CAAC+B,SAAS,CAAC,SAACC,QAAa,CAAK;AACjC,GAAIA,QAAQ,CAAE;AACb,GAAO,CAAAnE,MAAM,CAAgBmE,QAAQ,IAAtB3D,UAAU,CAAI2D,QAAQ;AACrC,GAAIhC,IAAI,CAACnC,MAAM,GAAKA,MAAM,CAAE;AAC3B,GAAI,CAACQ,UAAU,CAAE;AAChB2B,IAAI,CAACrB,QAAQ,CAAC,GAAI,CAAAsD,KAAK,CAAC,+BAA+B,CAAC,CAAC;AAC1D,CAAC,IAAM;AACNjC,IAAI,CAACnB,aAAa,CAACR,UAAU,CAAC;AAC/B;AACD;AACD;AACAuD,MAAI,CAACM,WAAW,CAAC,CAAC;AACnB,CAAC;AACF,CAAC;AACD,IAAI,CAACL,aAAa,CAACC,IAAI;AACtB9C,EAAE,CAACC,KAAK,CAAC8C,SAAS,CAAC,UAAM;AACxB,GAAI/B,IAAI,CAACnC,MAAM,GAAKwB,SAAS,CAAEW,IAAI,CAAClB,iBAAiB,CAAC,CAAC;AACvD8C,MAAI,CAACM,WAAW,CAAC,CAAC;AACnB,CAAC;AACF,CAAC;AACF,CAAC,CAAAT,MAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEDU,MAAM,CAAN,SAAAA,OAAA,CAAS;AACR,GAAO,CAAAnC,IAAI,CAAI,IAAI,CAACD,KAAK,CAAlBC,IAAI;AACX,MAAO,CAAAQ,MAAA,CAAAC,CAAA,CAAC2B,cAAc,EAACpC,IAAI,CAAEA,IAAK,CAACqC,UAAU;AAC5C7B,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY;AACrBT,IAAI,CAACnC,MAAM,GAAKwB,SAAS;AACzBmB,MAAA,CAAAC,CAAA,CAACc,WAAW,CAACe,cAAc,EAACtC,IAAI,CAAEA,IAAK,CAAE,CACzC;;AACAA,IAAI,CAACnC,MAAM,GAAKwB,SAAS,EAAImB,MAAA,CAAAC,CAAA,CAACX,YAAY,EAACE,IAAI,CAAEA,IAAK,CAAE;AACrD;AACU,CAAC;AAClB,CAAC,QAAAuB,WAAA,GArGwBgB,WAAW,EAAAC,OAAA,CAA/BjB,WAAW,CAAXA,WAAW,CA2BTkB,MAAM,CAAG,SAAC1C,KAAmC,CAAK,CACxD,GAAO,CAAA/B,MAAM,CAAI+B,KAAK,CAAf/B,MAAM,CACb,GAAIA,MAAM,CAAE,CACX,MACC,CAAAwC,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,WAAQiC,KAAK,CAAC,WAAW,EAAE1E,MAAe,CACxC,CAAC,CAEN,CACA,MAAO,KAAI,CACZ,CAAC,CArCIuD,WAAW,CAsCToB,gBAAgB,CAAG,UAAM,CAC/B,GAAI,CAACvB,aAAa,CAAE,CACnB,MAAO,CAAAZ,MAAA,CAAAC,CAAA,UAAG,YAAa,CAAC,CACzB,CACA,GAAI,CAAAmC,cAAsB,CAAG,EAAE,CAC/B,GAAI,CAAAC,QAAuB,CAAG,EAAE,CAChC,GAAI,CAAAC,OAAsB,CAAG,EAAE,CAAC,QAAAC,GAAA,GAAAC,gBAAA,CACJC,MAAM,CAACC,OAAO,CAAC9B,aAAa,CAAC,CAAA2B,GAAA,CAAAC,gBAAA,CAAA3F,MAAA,CAAA0F,GAAA,GAAE,KAAAI,IAAA,CAAAH,gBAAA,CAAAD,GAAA,KAA/C,CAAAK,GAAG,CAAAD,IAAA,OAAE,CAAAtF,MAAM,CAAAsF,IAAA,IACtB,GAAI,CAACtF,MAAM,CAACwF,KAAK,EAAI,CAACxF,MAAM,CAACyF,UAAU,CAAE,SACzC,GAAIzF,MAAM,CAAC0F,OAAO,GAAKX,cAAc,CAAE,CACtC,GAAIE,OAAO,CAACzF,MAAM,CAAG,CAAC,CAAE,CACvBwF,QAAQ,CAACf,IAAI,CAACtB,MAAA,CAAAC,CAAA,CAACD,MAAM,CAACa,QAAQ,EAAC+B,GAAG,CAAER,cAAe,EAClDpC,MAAA,CAAAC,CAAA,WAAKmC,cAAmB,CAAC,CACzBpC,MAAA,CAAAC,CAAA,OAAIiC,KAAK,CAAC,oCAAoC,EAC5CI,OACE,CACY,CAAC,CAAC,CACnBA,OAAO,CAAG,EAAE,CACb,CACAF,cAAc,CAAG/E,MAAM,CAAC0F,OAAO,CAChC,CACAT,OAAO,CAAChB,IAAI,CACXtB,MAAA,CAAAC,CAAA,OAAI2C,GAAG,CAAEA,GAAI,CAACV,KAAK,CAAC,YAAY,EAC/BlC,MAAA,CAAAC,CAAA,WACCO,IAAI,CAAC,UAAU,CACfZ,KAAK,WAAYgD,GAAM,CACvB,QAAM,QAAQ,CACdV,KAAK,CAAC,2DAA2D,EAEhEhC,SAAS,CAACC,YAAY,CAAC9C,MAAM,CAACC,EAAE,CAC1B,CACL,CACL,CAAC,CACF,CACA,MAAO,CAAA0C,MAAA,CAAAC,CAAA,CAAAD,MAAA,CAAAa,QAAA,MAAGwB,QAAW,CAAC,CACvB,CAAC,CAzEItB,WAAW,CA0ETe,cAAc,CAAG,SAACvC,KAAyB,CAAK,CACtD,GAAO,CAAAC,IAAI,CAAID,KAAK,CAAbC,IAAI,CACX,MAAO,CAAAQ,MAAA,CAAAC,CAAA,CAAAD,MAAA,CAAAa,QAAA,MACNb,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,MAAG,QAAM,QAAQ,CAAC+C,IAAI,KAAMC,MAAM,CAACC,MAAM,CAACC,KAAK,IAAI,CAACC,MAAM,CAAC,QAAQ,EAAC,kCAEjE,CACD,CAAC,CACJpD,MAAA,CAAAC,CAAA,CAAC+B,OAAW,CAACC,MAAM,EAACzE,MAAM,CAAEgC,IAAI,CAAChC,MAAO,CAAE,CAAC,CAC3CwC,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,WAAQO,IAAI,CAAC,UAAU,CAACZ,KAAK,CAAC,iBAAiB,CAAC,QAAM,QAAQ,EAC7DI,MAAA,CAAAC,CAAA,MAAG,QAAM,mBAAmB,CAAI,CAAC,wBAC1B,CACN,CAAC,CACJD,MAAA,CAAAC,CAAA,CAAC+B,OAAW,CAACG,gBAAgB,KAAE,CAC9B,CAAC,CACJ,CAAC;;;AAcF3D,EAAE,CAAC6E,SAAS,CAAC,QAAQ,CAAC,CAAG;AACxBC,KAAK,CAAE/G,UAAU;AACjBgH,SAAS,CAAExC;AACZ,CAAC;AACDvC,EAAE,CAACgF,eAAe,CAAC,CAAC"}