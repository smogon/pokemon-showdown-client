{"version":3,"file":"panel-mainmenu.js","names":["MainMenuRoom","_PSRoom","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","classType","userdetailsCache","roomsCache","_proto","prototype","receiveLine","_this2","cmd","challstr","PSLoginServer","query","act","then","res","loggedin","send","username","assertion","fullName","namedCode","avatar","PS","user","setName","challengesBuf","receiveChallenges","queryId","responseJSON","handleQueryResponse","JSON","parse","user1","user2","message","handlePM","parseFormats","alert","replace","lobby","rooms","dataBuf","json","_unused","userid","challengesFrom","getPMRoom","toID","challengeTo","to","roomid","_json$challengeTo","_json$challengeTo2","room","pmTarget","targetUserid","challengedFormat","challengingFormat","format","update","formatsList","isSection","section","column","window","NonBattleGames","rps","i","BattleFormats","j","entry","teams","usesLocalLadder","charAt","isNaN","Number","slice","parseInt","_BattleFormats$_id","name","searchShow","challengeShow","tournamentShow","team","teambuilderLevel","lastCommaIndex","lastIndexOf","code","substr","NaN","id","isTeambuilderFormat","teambuilderFormat","teambuilderFormatName","parenPos","indexOf","trim","rated","effectType","multivariantFormats","battleFormat","userid1","userid2","sort","join","addRoom","response","userdetails","Object","assign","userRoom","pspl","_i2","_response$pspl2","roomInfo","spotlight","chat","official","_i4","_response$official2","roomsRoom","battlesRoom","battleTable","battles","battleid","push","ladderRoomEntries","entries","filter","startsWith","_i6","_ref","ladderRoom","PSRoom","NewsPanel","_PSRoomPanel","_proto2","render","preact","h","PSPanelWrapper","props","scrollable","dangerouslySetInnerHTML","__html","newsHTML","PSRoomPanel","MainMenuPanel","_PSRoomPanel2","_this3","_len2","_key2","submit","e","handleDragStart","currentTarget","getAttribute","dragging","type","_proto3","focus","base","querySelector","renderMiniRoom","roomType","roomTypes","Panel","Component","key","renderMiniRooms","_this4","miniRoomList","map","draggable","onDragStart","value","tabIndex","title","renderSearchButton","down","style","textAlign","width","height","src","Config","routes","client","alt","isOffline","TeamForm","onSubmit","onlineButton","display","leftRoomWidth","server","href","dex","target","replays","root","FormatDropdown","_preact$Component","_this5","_len3","_key3","change","forceUpdate","onChange","_proto4","disabled","TeamDropdown","_preact$Component2","_this6","_len4","_key4","teamFormat","teamKey","_proto5","getDefaultTeam","_i8","_PS$teams$list2","list","_window$BattleFormats","formatData","Dex","getPokemonIcon","byKey","TeamBox","noLink","_preact$Component3","_this7","_len5","_key5","state","changeFormat","setState","preventDefault","undefined","_proto6","children","Model"],"sources":["../src/panel-mainmenu.tsx"],"sourcesContent":["/**\r\n * Main menu panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\ntype RoomInfo = {\r\n\ttitle: string, desc?: string, userCount?: number, section?: string, spotlight?: string, subRooms?: string[],\r\n};\r\n\r\nclass MainMenuRoom extends PSRoom {\r\n\treadonly classType: string = 'mainmenu';\r\n\tuserdetailsCache: {[userid: string]: {\r\n\t\tuserid: ID,\r\n\t\tavatar?: string | number,\r\n\t\tstatus?: string,\r\n\t\tgroup?: string,\r\n\t\tcustomgroup?: string,\r\n\t\trooms?: {[roomid: string]: {isPrivate?: true, p1?: string, p2?: string}},\r\n\t}} = {};\r\n\troomsCache: {\r\n\t\tbattleCount?: number,\r\n\t\tuserCount?: number,\r\n\t\tchat?: RoomInfo[],\r\n\t\tsectionTitles?: string[],\r\n\t} = {};\r\n\treceiveLine(args: Args) {\r\n\t\tconst [cmd] = args;\r\n\t\tswitch (cmd) {\r\n\t\tcase 'challstr': {\r\n\t\t\tconst [, challstr] = args;\r\n\t\t\tPSLoginServer.query({\r\n\t\t\t\tact: 'upkeep',\r\n\t\t\t\tchallstr,\r\n\t\t\t}).then(res => {\r\n\t\t\t\tif (!res) return;\r\n\t\t\t\tif (!res.loggedin) return;\r\n\t\t\t\tthis.send(`/trn ${res.username},0,${res.assertion}`);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} case 'updateuser': {\r\n\t\t\tconst [, fullName, namedCode, avatar] = args;\r\n\t\t\tPS.user.setName(fullName, namedCode === '1', avatar);\r\n\t\t\treturn;\r\n\t\t} case 'updatechallenges': {\r\n\t\t\tconst [, challengesBuf] = args;\r\n\t\t\tthis.receiveChallenges(challengesBuf);\r\n\t\t\treturn;\r\n\t\t} case 'queryresponse': {\r\n\t\t\tconst [, queryId, responseJSON] = args;\r\n\t\t\tthis.handleQueryResponse(queryId as ID, JSON.parse(responseJSON));\r\n\t\t\treturn;\r\n\t\t} case 'pm': {\r\n\t\t\tconst [, user1, user2, message] = args;\r\n\t\t\tthis.handlePM(user1, user2, message);\r\n\t\t\treturn;\r\n\t\t} case 'formats': {\r\n\t\t\tthis.parseFormats(args);\r\n\t\t\treturn;\r\n\t\t} case 'popup': {\r\n\t\t\tconst [, message] = args;\r\n\t\t\talert(message.replace(/\\|\\|/g, '\\n'));\r\n\t\t\treturn;\r\n\t\t}}\r\n\t\tconst lobby = PS.rooms['lobby'];\r\n\t\tif (lobby) lobby.receiveLine(args);\r\n\t}\r\n\treceiveChallenges(dataBuf: string) {\r\n\t\tlet json;\r\n\t\ttry {\r\n\t\t\tjson = JSON.parse(dataBuf);\r\n\t\t} catch {}\r\n\t\tfor (const userid in json.challengesFrom) {\r\n\t\t\tPS.getPMRoom(toID(userid));\r\n\t\t}\r\n\t\tif (json.challengeTo) {\r\n\t\t\tPS.getPMRoom(toID(json.challengeTo.to));\r\n\t\t}\r\n\t\tfor (const roomid in PS.rooms) {\r\n\t\t\tconst room = PS.rooms[roomid] as ChatRoom;\r\n\t\t\tif (!room.pmTarget) continue;\r\n\t\t\tconst targetUserid = toID(room.pmTarget);\r\n\t\t\tif (!room.challengedFormat && !(targetUserid in json.challengesFrom) &&\r\n\t\t\t\t!room.challengingFormat && json.challengeTo?.to !== targetUserid) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\troom.challengedFormat = json.challengesFrom[targetUserid] || null;\r\n\t\t\troom.challengingFormat = json.challengeTo?.to === targetUserid ? json.challengeTo.format : null;\r\n\t\t\troom.update(null);\r\n\t\t}\r\n\t}\r\n\tparseFormats(formatsList: string[]) {\r\n\t\tlet isSection = false;\r\n\t\tlet section = '';\r\n\r\n\t\tlet column = 0;\r\n\r\n\t\twindow.NonBattleGames = {rps: 'Rock Paper Scissors'};\r\n\t\tfor (let i = 3; i <= 9; i = i + 2) {\r\n\t\t\twindow.NonBattleGames['bestof' + i] = 'Best-of-' + i;\r\n\t\t}\r\n\t\twindow.BattleFormats = {};\r\n\t\tfor (let j = 1; j < formatsList.length; j++) {\r\n\t\t\tconst entry = formatsList[j];\r\n\t\t\tif (isSection) {\r\n\t\t\t\tsection = entry;\r\n\t\t\t\tisSection = false;\r\n\t\t\t} else if (entry === ',LL') {\r\n\t\t\t\tPS.teams.usesLocalLadder = true;\r\n\t\t\t} else if (entry === '' || (entry.charAt(0) === ',' && !isNaN(Number(entry.slice(1))))) {\r\n\t\t\t\tisSection = true;\r\n\r\n\t\t\t\tif (entry) {\r\n\t\t\t\t\tcolumn = parseInt(entry.slice(1), 10) || 0;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tlet name = entry;\r\n\t\t\t\tlet searchShow = true;\r\n\t\t\t\tlet challengeShow = true;\r\n\t\t\t\tlet tournamentShow = true;\r\n\t\t\t\tlet team: 'preset' | null = null;\r\n\t\t\t\tlet teambuilderLevel: number | null = null;\r\n\t\t\t\tlet lastCommaIndex = name.lastIndexOf(',');\r\n\t\t\t\tlet code = lastCommaIndex >= 0 ? parseInt(name.substr(lastCommaIndex + 1), 16) : NaN;\r\n\t\t\t\tif (!isNaN(code)) {\r\n\t\t\t\t\tname = name.substr(0, lastCommaIndex);\r\n\t\t\t\t\tif (code & 1) team = 'preset';\r\n\t\t\t\t\tif (!(code & 2)) searchShow = false;\r\n\t\t\t\t\tif (!(code & 4)) challengeShow = false;\r\n\t\t\t\t\tif (!(code & 8)) tournamentShow = false;\r\n\t\t\t\t\tif (code & 16) teambuilderLevel = 50;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Backwards compatibility: late 0.9.0 -> 0.10.0\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',#') { // preset teams\r\n\t\t\t\t\t\tteam = 'preset';\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',,') { // search-only\r\n\t\t\t\t\t\tchallengeShow = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t} else if (name.substr(name.length - 1) === ',') { // challenge-only\r\n\t\t\t\t\t\tsearchShow = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet id = toID(name);\r\n\t\t\t\tlet isTeambuilderFormat = !team && name.slice(-11) !== 'Custom Game';\r\n\t\t\t\tlet teambuilderFormat = '' as ID;\r\n\t\t\t\tlet teambuilderFormatName = '';\r\n\t\t\t\tif (isTeambuilderFormat) {\r\n\t\t\t\t\tteambuilderFormatName = name;\r\n\t\t\t\t\tif (id.slice(0, 3) !== 'gen') {\r\n\t\t\t\t\t\tteambuilderFormatName = '[Gen 6] ' + name;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet parenPos = teambuilderFormatName.indexOf('(');\r\n\t\t\t\t\tif (parenPos > 0 && name.slice(-1) === ')') {\r\n\t\t\t\t\t\t// variation of existing tier\r\n\t\t\t\t\t\tteambuilderFormatName = teambuilderFormatName.slice(0, parenPos).trim();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (teambuilderFormatName !== name) {\r\n\t\t\t\t\t\tteambuilderFormat = toID(teambuilderFormatName);\r\n\t\t\t\t\t\tif (BattleFormats[teambuilderFormat]) {\r\n\t\t\t\t\t\t\tBattleFormats[teambuilderFormat].isTeambuilderFormat = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tBattleFormats[teambuilderFormat] = {\r\n\t\t\t\t\t\t\t\tid: teambuilderFormat,\r\n\t\t\t\t\t\t\t\tname: teambuilderFormatName,\r\n\t\t\t\t\t\t\t\tteam,\r\n\t\t\t\t\t\t\t\tsection,\r\n\t\t\t\t\t\t\t\tcolumn,\r\n\t\t\t\t\t\t\t\trated: false,\r\n\t\t\t\t\t\t\t\tisTeambuilderFormat: true,\r\n\t\t\t\t\t\t\t\teffectType: 'Format',\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tisTeambuilderFormat = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (BattleFormats[id]?.isTeambuilderFormat) {\r\n\t\t\t\t\tisTeambuilderFormat = true;\r\n\t\t\t\t}\r\n\t\t\t\t// make sure formats aren't out-of-order\r\n\t\t\t\tif (BattleFormats[id]) delete BattleFormats[id];\r\n\t\t\t\tBattleFormats[id] = {\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tteam,\r\n\t\t\t\t\tsection,\r\n\t\t\t\t\tcolumn,\r\n\t\t\t\t\tsearchShow,\r\n\t\t\t\t\tchallengeShow,\r\n\t\t\t\t\ttournamentShow,\r\n\t\t\t\t\trated: searchShow && id.substr(4, 7) !== 'unrated',\r\n\t\t\t\t\tteambuilderLevel,\r\n\t\t\t\t\tteambuilderFormat,\r\n\t\t\t\t\tisTeambuilderFormat,\r\n\t\t\t\t\teffectType: 'Format',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Match base formats to their variants, if they are unavailable in the server.\r\n\t\tlet multivariantFormats: {[id: string]: 1} = {};\r\n\t\tfor (let id in BattleFormats) {\r\n\t\t\tlet teambuilderFormat = BattleFormats[BattleFormats[id].teambuilderFormat!];\r\n\t\t\tif (!teambuilderFormat || multivariantFormats[teambuilderFormat.id]) continue;\r\n\t\t\tif (!teambuilderFormat.searchShow && !teambuilderFormat.challengeShow && !teambuilderFormat.tournamentShow) {\r\n\t\t\t\t// The base format is not available.\r\n\t\t\t\tif (teambuilderFormat.battleFormat) {\r\n\t\t\t\t\tmultivariantFormats[teambuilderFormat.id] = 1;\r\n\t\t\t\t\tteambuilderFormat.battleFormat = '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tteambuilderFormat.battleFormat = id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tPS.teams.update('format');\r\n\t}\r\n\thandlePM(user1: string, user2: string, message: string) {\r\n\t\tconst userid1 = toID(user1);\r\n\t\tconst userid2 = toID(user2);\r\n\t\tconst roomid = `pm-${[userid1, userid2].sort().join('-')}` as RoomID;\r\n\t\tlet room = PS.rooms[roomid];\r\n\t\tif (!room) {\r\n\t\t\tconst pmTarget = PS.user.userid === userid1 ? user2 : user1;\r\n\t\t\tPS.addRoom({\r\n\t\t\t\tid: roomid,\r\n\t\t\t\tpmTarget,\r\n\t\t\t}, true);\r\n\t\t\troom = PS.rooms[roomid]!;\r\n\t\t}\r\n\t\troom.receiveLine([`c`, user1, message]);\r\n\t\tPS.update();\r\n\t}\r\n\thandleQueryResponse(id: ID, response: any) {\r\n\t\tswitch (id) {\r\n\t\tcase 'userdetails':\r\n\t\t\tlet userid = response.userid;\r\n\t\t\tlet userdetails = this.userdetailsCache[userid];\r\n\t\t\tif (!userdetails) {\r\n\t\t\t\tthis.userdetailsCache[userid] = response;\r\n\t\t\t} else {\r\n\t\t\t\tObject.assign(userdetails, response);\r\n\t\t\t}\r\n\t\t\tconst userRoom = PS.rooms[`user-${userid}`] as UserRoom;\r\n\t\t\tif (userRoom) userRoom.update(null);\r\n\t\t\tbreak;\r\n\t\tcase 'rooms':\r\n\t\t\tif (response.pspl) {\r\n\t\t\t\tfor (const roomInfo of response.pspl) roomInfo.spotlight = \"Spotlight\";\r\n\t\t\t\tresponse.chat = [...response.pspl, ...response.chat];\r\n\t\t\t\tresponse.pspl = null;\r\n\t\t\t}\r\n\t\t\tif (response.official) {\r\n\t\t\t\tfor (const roomInfo of response.official) roomInfo.section = \"Official\";\r\n\t\t\t\tresponse.chat = [...response.official, ...response.chat];\r\n\t\t\t\tresponse.official = null;\r\n\t\t\t}\r\n\t\t\tthis.roomsCache = response;\r\n\t\t\tconst roomsRoom = PS.rooms[`rooms`] as RoomsRoom;\r\n\t\t\tif (roomsRoom) roomsRoom.update(null);\r\n\t\t\tbreak;\r\n\t\tcase 'roomlist':\r\n\t\t\tconst battlesRoom = PS.rooms[`battles`] as BattlesRoom;\r\n\t\t\tif (battlesRoom) {\r\n\t\t\t\tconst battleTable = response.rooms;\r\n\t\t\t\tconst battles = [];\r\n\t\t\t\tfor (const battleid in battleTable) {\r\n\t\t\t\t\tbattleTable[battleid].id = battleid;\r\n\t\t\t\t\tbattles.push(battleTable[battleid]);\r\n\t\t\t\t}\r\n\t\t\t\tbattlesRoom.battles = battles;\r\n\t\t\t\tbattlesRoom.update(null);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'laddertop':\r\n\t\t\tconst ladderRoomEntries = Object.entries(PS.rooms).filter(entry => entry[0].startsWith('ladder'));\r\n\t\t\tfor (const [, ladderRoom] of ladderRoomEntries) {\r\n\t\t\t\t(ladderRoom as LadderRoom).update(response);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass NewsPanel extends PSRoomPanel {\r\n\trender() {\r\n\t\treturn <PSPanelWrapper room={this.props.room} scrollable>\r\n\t\t\t<div class=\"mini-window-body\" dangerouslySetInnerHTML={{__html: PS.newsHTML}}></div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nclass MainMenuPanel extends PSRoomPanel<MainMenuRoom> {\r\n\tfocus() {\r\n\t\t(this.base!.querySelector('button.big') as HTMLButtonElement).focus();\r\n\t}\r\n\tsubmit = (e: Event) => {\r\n\t\talert('todo: implement');\r\n\t};\r\n\thandleDragStart = (e: DragEvent) => {\r\n\t\tconst roomid = (e.currentTarget as HTMLElement).getAttribute('data-roomid') as RoomID;\r\n\t\tPS.dragging = {type: 'room', roomid};\r\n\t};\r\n\trenderMiniRoom(room: PSRoom) {\r\n\t\tconst roomType = PS.roomTypes[room.type];\r\n\t\tconst Panel = roomType ? roomType.Component : PSRoomPanel;\r\n\t\treturn <Panel key={room.id} room={room} />;\r\n\t}\r\n\trenderMiniRooms() {\r\n\t\treturn PS.miniRoomList.map(roomid => {\r\n\t\t\tconst room = PS.rooms[roomid]!;\r\n\t\t\treturn <div class=\"pmbox\">\r\n\t\t\t\t<div class=\"mini-window\">\r\n\t\t\t\t\t<h3 draggable onDragStart={this.handleDragStart} data-roomid={roomid}>\r\n\t\t\t\t\t\t<button class=\"closebutton\" name=\"closeRoom\" value={roomid} aria-label=\"Close\" tabIndex={-1}><i class=\"fa fa-times-circle\"></i></button>\r\n\t\t\t\t\t\t<button class=\"minimizebutton\" tabIndex={-1}><i class=\"fa fa-minus-circle\"></i></button>\r\n\t\t\t\t\t\t{room.title}\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t{this.renderMiniRoom(room)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t});\r\n\t}\r\n\trenderSearchButton() {\r\n\t\tif (PS.down) {\r\n\t\t\treturn <div class=\"menugroup\" style=\"background: rgba(10,10,10,.6)\">\r\n\t\t\t\t{PS.down === 'ddos' ?\r\n\t\t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to a DDoS attack!</strong></p>\r\n\t\t\t\t:\r\n\t\t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to technical difficulties!</strong></p>\r\n\t\t\t\t}\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<div style={{textAlign: 'center'}}>\r\n\t\t\t\t\t\t<img width=\"96\" height=\"96\" src={`//${Config.routes.client}/sprites/gen5/teddiursa.png`} alt=\"\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\tBear with us as we freak out.\r\n\t\t\t\t</p>\r\n\t\t\t\t<p>(We'll be back up in a few hours.)</p>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\tif (!PS.user.userid || PS.isOffline) {\r\n\t\t\treturn <TeamForm class=\"menugroup\" onSubmit={this.submit}>\r\n\t\t\t\t<button class=\"mainmenu1 big button disabled\" name=\"search\">\r\n\t\t\t\t\t<em>{PS.isOffline ? \"Disconnected\" : \"Connecting...\"}</em>\r\n\t\t\t\t</button>\r\n\t\t\t</TeamForm>;\r\n\t\t}\r\n\r\n\t\treturn <TeamForm class=\"menugroup\" onSubmit={this.submit}>\r\n\t\t\t<button class=\"mainmenu1 big button\" name=\"search\">\r\n\t\t\t\t<strong>Battle!</strong><br />\r\n\t\t\t\t<small>Find a random opponent</small>\r\n\t\t\t</button>\r\n\t\t</TeamForm>;\r\n\t}\r\n\trender() {\r\n\t\tconst onlineButton = ' button' + (PS.isOffline ? ' disabled' : '');\r\n\t\treturn <PSPanelWrapper room={this.props.room} scrollable>\r\n\t\t\t<div class=\"mainmenuwrapper\">\r\n\t\t\t\t<div class=\"leftmenu\">\r\n\t\t\t\t\t<div class=\"activitymenu\">\r\n\t\t\t\t\t\t{this.renderMiniRooms()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"mainmenu\">\r\n\t\t\t\t\t\t{this.renderSearchButton()}\r\n\r\n\t\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t\t<p><button class=\"mainmenu2 button\" name=\"joinRoom\" value=\"teambuilder\">Teambuilder</button></p>\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu3\" + onlineButton} name=\"joinRoom\" value=\"ladder\">Ladder</button></p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu4\" + onlineButton} name=\"joinRoom\" value=\"battles\">Watch a battle</button></p>\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu5\" + onlineButton} name=\"finduser\">Find a user</button></p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"rightmenu\" style={{display: PS.leftRoomWidth ? 'none' : 'block'}}>\r\n\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t{PS.server.id === 'showdown' ?\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu1\" + onlineButton} name=\"joinRoom\" value=\"rooms\">Join chat</button></p>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu1\" + onlineButton} name=\"joinRoom\" value=\"lobby\">Join lobby chat</button></p>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"mainmenufooter\">\r\n\t\t\t\t\t<div class=\"bgcredit\"></div>\r\n\t\t\t\t\t<small>\r\n\t\t\t\t\t\t<a href={`//${Config.routes.dex}/`} target=\"_blank\">Pok&eacute;dex</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.replays}/`} target=\"_blank\">Replays</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.root}/rules`} target=\"_blank\">Rules</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.dex}/credits`} target=\"_blank\">Credits</a> | {}\r\n\t\t\t\t\t\t<a href=\"//smogon.com/forums/\" target=\"_blank\">Forum</a>\r\n\t\t\t\t\t</small>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nclass FormatDropdown extends preact.Component<{format?: string, onChange?: JSX.EventHandler<Event>}> {\r\n\tdeclare base?: HTMLButtonElement;\r\n\tformat = '[Gen 7] Random Battle';\r\n\tchange = (e: Event) => {\r\n\t\tif (!this.base) return;\r\n\t\tthis.format = this.base.value;\r\n\t\tthis.forceUpdate();\r\n\t\tif (this.props.onChange) this.props.onChange(e);\r\n\t};\r\n\trender() {\r\n\t\tif (this.props.format) {\r\n\t\t\treturn <button\r\n\t\t\tname=\"format\" value={this.props.format} class=\"select formatselect preselected\" disabled\r\n\t\t\t>{this.props.format}</button>;\r\n\t\t}\r\n\t\treturn <button\r\n\t\t\tname=\"format\" value={this.format}\r\n\t\t\tclass=\"select formatselect\" data-href=\"/formatdropdown\" onChange={this.change}\r\n\t\t>\r\n\t\t\t{this.format}\r\n\t\t</button>;\r\n\t}\r\n}\r\n\r\nclass TeamDropdown extends preact.Component<{format: string}> {\r\n\tteamFormat = '';\r\n\tteamKey = '';\r\n\tchange = () => {\r\n\t\tif (!this.base) return;\r\n\t\tthis.teamKey = (this.base as HTMLButtonElement).value;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\tgetDefaultTeam(teambuilderFormat: string) {\r\n\t\tfor (const team of PS.teams.list) {\r\n\t\t\tif (team.format === teambuilderFormat) return team.key;\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\trender() {\r\n\t\tconst teamFormat = PS.teams.teambuilderFormat(this.props.format);\r\n\t\tconst formatData = window.BattleFormats?.[teamFormat];\r\n\t\tif (formatData && formatData.team) {\r\n\t\t\treturn <button class=\"select teamselect preselected\" name=\"team\" value=\"random\" disabled>\r\n\t\t\t\t<div class=\"team\">\r\n\t\t\t\t\t<strong>Random team</strong>\r\n\t\t\t\t\t<small>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t</small>\r\n\t\t\t\t</div>\r\n\t\t\t</button>;\r\n\t\t}\r\n\t\tif (teamFormat !== this.teamFormat) {\r\n\t\t\tthis.teamFormat = teamFormat;\r\n\t\t\tthis.teamKey = this.getDefaultTeam(teamFormat);\r\n\t\t}\r\n\t\tconst team = PS.teams.byKey[this.teamKey] || null;\r\n\t\treturn <button\r\n\t\t\tname=\"team\" value={this.teamKey}\r\n\t\t\tclass=\"select teamselect\" data-href=\"/teamdropdown\" data-format={teamFormat} onChange={this.change}\r\n\t\t>\r\n\t\t\t{PS.roomTypes['teamdropdown'] && <TeamBox team={team} noLink />}\r\n\t\t</button>;\r\n\t}\r\n}\r\n\r\nclass TeamForm extends preact.Component<{\r\n\tchildren: preact.ComponentChildren, class?: string, format?: string,\r\n\tonSubmit: null | ((e: Event, format: string, team?: Team) => void),\r\n}> {\r\n\tstate = {format: '[Gen 7] Random Battle'};\r\n\tchangeFormat = (e: Event) => {\r\n\t\tthis.setState({format: (e.target as HTMLButtonElement).value});\r\n\t};\r\n\tsubmit = (e: Event) => {\r\n\t\te.preventDefault();\r\n\t\tconst format = (this.base!.querySelector('button[name=format]') as HTMLButtonElement).value;\r\n\t\tconst teamKey = (this.base!.querySelector('button[name=team]') as HTMLButtonElement).value;\r\n\t\tconst team = teamKey ? PS.teams.byKey[teamKey] : undefined;\r\n\t\tif (this.props.onSubmit) this.props.onSubmit(e, format, team);\r\n\t};\r\n\trender() {\r\n\t\treturn <form class={this.props.class} onSubmit={this.submit}>\r\n\t\t\t<p>\r\n\t\t\t\t<label class=\"label\">\r\n\t\t\t\t\tFormat:<br />\r\n\t\t\t\t\t<FormatDropdown onChange={this.changeFormat} format={this.props.format} />\r\n\t\t\t\t</label>\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t<label class=\"label\">\r\n\t\t\t\t\tTeam:<br />\r\n\t\t\t\t\t<TeamDropdown format={this.state.format} />\r\n\t\t\t\t</label>\r\n\t\t\t</p>\r\n\t\t\t<p>{this.props.children}</p>\r\n\t\t</form>;\r\n\t}\r\n}\r\n\r\nPS.roomTypes['news'] = {\r\n\tComponent: NewsPanel,\r\n};\r\n\r\nPS.roomTypes['mainmenu'] = {\r\n\tModel: MainMenuRoom,\r\n\tComponent: MainMenuPanel,\r\n};\r\n"],"mappings":"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"}